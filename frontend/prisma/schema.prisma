generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model BlogPost {
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title          String
  slug           String    @unique
  excerpt        String?
  content        String?   // Markdown content stored directly
  contentUrl     String?   @map("content_url") // Optional: for external content
  coverImageUrl  String?   @map("cover_image_url")
  tags           String[]  @default([])
  published      Boolean   @default(false)
  publishedAt    DateTime? @map("published_at") @db.Timestamptz(6)
  readingTime    Int       @default(0) @map("reading_time")
  views          Int       @default(0)
  createdAt      DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt      DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@index([createdAt(sort: Desc)])
  @@index([publishedAt(sort: Desc)])
  @@index([slug])
  @@map("blog_posts")
}

model MediaFile {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  originalName String   @map("original_name")
  storagePath  String   @map("storage_path")
  url          String
  mimeType     String   @map("mime_type")
  sizeBytes    BigInt   @map("size_bytes")
  uploadedBy   String?  @map("uploaded_by") @db.Uuid
  metadata     Json     @default("{}")
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  users        User?    @relation(fields: [uploadedBy], references: [id])

  @@index([createdAt(sort: Desc)])
  @@index([mimeType])
  @@index([uploadedBy])
  @@map("media_files")
}

model Profile {
  id                String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name              String    @db.VarChar(255)
  title             String    @db.VarChar(255)
  bio               String?
  email             String    @db.VarChar(255)
  phone             String?   @db.VarChar(50)
  location          String?   @db.VarChar(255)
  profileImageUrl   String?   @map("profile_image_url")
  resumeUrl         String?   @map("resume_url")
  heroTitle         String    @map("hero_title") @db.VarChar(255)
  heroSubtitle      String    @map("hero_subtitle")
  availableForWork  Boolean?  @default(true) @map("available_for_work")
  githubUrl         String?   @map("github_url")
  linkedinUrl       String?   @map("linkedin_url")
  twitterUrl        String?   @map("twitter_url")
  websiteUrl        String?   @map("website_url")
  createdAt         DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt         DateTime? @default(now()) @map("updated_at") @db.Timestamptz(6)

  @@index([email], map: "idx_profile_email")
  @@map("profile")
}

model Project {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title        String
  slug         String   @unique
  description  String?
  techStack    String[] @default([]) @map("tech_stack")
  githubUrl    String?  @map("github_url")
  demoUrl      String?  @map("demo_url")
  thumbnailUrl String?  @map("thumbnail_url")
  images       String[] @default([])
  published    Boolean  @default(false)
  displayOrder Int      @default(0) @map("display_order")
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@index([displayOrder])
  @@index([published])
  @@index([slug])
  @@map("projects")
}

model Publication {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title     String
  slug      String   @unique
  authors   String[]
  year      Int
  venue     String?
  doi       String?
  arxivId   String?  @map("arxiv_id")
  pdfUrl    String?  @map("pdf_url")
  abstract  String?
  tags      String[] @default([])
  published Boolean  @default(false)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@index([published])
  @@index([slug])
  @@index([year(sort: Desc)])
  @@map("publications")
}

model User {
  id         String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email      String      @unique
  name       String?
  avatarUrl  String?     @map("avatar_url")
  role       String      @default("admin")
  createdAt  DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime    @updatedAt @map("updated_at") @db.Timestamptz(6)
  mediaFiles MediaFile[]

  @@index([email])
  @@map("users")
}

model WorkExperience {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  company      String
  position     String
  location     String?
  startDate    DateTime  @map("start_date") @db.Date
  endDate      DateTime? @map("end_date") @db.Date
  current      Boolean   @default(false)
  description  String?
  achievements String[]  @default([])
  technologies String[]  @default([])
  companyUrl   String?   @map("company_url")
  displayOrder Int       @default(0) @map("display_order")
  published    Boolean   @default(false)
  createdAt    DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@index([displayOrder])
  @@index([published])
  @@index([startDate(sort: Desc)])
  @@map("work_experiences")
}

model Education {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  institution  String
  degree       String
  fieldOfStudy String    @map("field_of_study")
  location     String?
  startDate    DateTime  @map("start_date") @db.Date
  endDate      DateTime? @map("end_date") @db.Date
  current      Boolean   @default(false)
  grade        String?
  description  String?
  achievements String[]  @default([])
  courses      String[]  @default([])
  institutionUrl String? @map("institution_url")
  displayOrder Int       @default(0) @map("display_order")
  published    Boolean   @default(false)
  createdAt    DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@index([displayOrder])
  @@index([published])
  @@index([startDate(sort: Desc)])
  @@map("education")
}

model Skill {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name         String
  category     String   // e.g., "Programming Languages", "Frameworks", "Tools"
  proficiency  Int      @default(50) // 0-100 percentage
  iconUrl      String?  @map("icon_url")
  description  String?
  displayOrder Int      @default(0) @map("display_order")
  published    Boolean  @default(false)
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@index([category])
  @@index([displayOrder])
  @@index([published])
  @@map("skills")
}

model Contact {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name      String   @db.VarChar(255)
  email     String   @db.VarChar(255)
  message   String
  read      Boolean  @default(false)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@index([createdAt(sort: Desc)])
  @@index([read])
  @@map("contacts")
}
